AMBIGUOUS_PACKAGES = {
    'acroread-fonts-systemwide': ['non-free'],
    'adobe-base-14-fonts': ['non-free'],
    'adobe-source-code-pro-fonts': ['OFL'],
    'adobe-source-sans-pro-fonts': ['OFL'],
    'adobe-source-serif-pro-fonts': ['OFL'],
    'bzip2': ['bzip2'],
    'db': ['Sleepycat'],
    'cups-filters': ['GPL', 'GPL2', 'GPL3-only', 'GPL3'],
    'expat': ['MIT'],
    'flashplugin': ['non-free'],
    'fontconfig': ['HPND'],
    'gd': ['GD'],
    'ghc': ['BSD3'],
    'ghc-libs': ['BSD3'],
    'hdf5': ['BSD3'],
    'intel-ucode': ['non-free'],
    'java-openjfx': ['GPL2'],
    'jdk8-openjdk': ['GPL2'],
    'jdk-openjdk': ['GPL2'],
    'jre8-openjdk': ['GPL2'],
    'jre8-openjdk-headless': ['GPL2'],
    'jre-openjdk': ['GPL2'],
    'jre-openjdk-headless': ['GPL2'],
    'jre11-openjdk': ['GPL2'],
    'jre11-openjdk-headless': ['GPL2'],
    'l-smash': ['ISC'],
    'lib32-sqlite': ['publicdomain'],
    'libaec': ['BSD2'],
    'libdrm': ['MIT'],
    'libfontenc': ['MIT'],
    'libice': ['X11'],
    'libldap': ['OpenLDAP'],
    'libmodplug': ['publicdomain'],
    'libmng': ['ZLIB'],
    'libpciaccess': ['MIT', 'ISC', 'X11'],
    'libpng': ['libpng'],
    'libpng12': ['libpng'],
    'libsm': ['MIT', 'X11'],
    'libtiff': ['libtiff'],
    'libuv': ['MIT', 'BSD2', 'BSD3', 'ISC'],
    'libvdpau': ['MIT'],
    'libwpe': ['BSD2'],
    'libx11': ['MIT', 'X11', 'TekHVC'],
    'libxau': ['X11'],
    'libxcomposite': ['libxcomposite', 'MIT'],
    'libxfixes': ['HPND', 'MIT'],
    'libxft': ['HPND'],
    'libxi': ['X11', 'HPND', 'MIT'],
    'libxinerama': ['MIT', 'X11'],
    'libxv': ['HPND'],
    'lsof': ['lsof'],
    'mesa': ['MIT', 'Khronos', 'SGI'],
    'mesa-demos': ['MIT', 'SGI', 'LGPL'],
    'minizip': ['ZLIB'],
    'ntp': ['HPND', 'BSD2'],
    'nvidia': ['non-free'],
    'nvidia-dkms': ['non-free'],
    'nvidia-utils': ['non-free'],
    'openjdk8-src': ['GPL2'],
    'orc': ['BSD2', 'BSD3'],
    'pepper-flash': ['non-free'],
    'pigz': ['ZLIB'],
    'pixman': ['MIT'],
    'python': ['Python'],
    'python2': ['Python'],
    'python-docutils': ['publicdomain', 'BSD2', 'Python', 'GPL3'],
    'python-numpy': ['BSD3'],
    'popt': ['X11'],
    'qhull': ['Qhull'],
    'rogue': ['BSD3'],
    'rpcbind': ['BSD3'],
    'steam': ['non-free'],
    'sudo': ['ISC', 'BSD3', 'BSD2', 'ZLIB'],
    'tcl': ['tcl'],
    'ttf-bitstream-vera': ['bitstream-vera'],
    'ttf-dejavu': ['publicdomain', 'bitstream-vera'],
    'unrar': ['non-free'],
    'vulkan-icd-loader': ['Apache'],
    'w3m': ['w3m'],
    'webrtc-audio-processing': ['BSD3'],
    'xorg-server-xwayland': ['MIT'],
    'xorg-x11perf': ['HPND'],
    'xorg-xhost': ['MIT', 'X11'],
    'xorg-xinput': ['MIT'],
    'xorg-xkbevd': ['HPND'],
    'xorg-xkbutils': ['HPND', 'X11-DEC', 'MIT'],
    'zip': ['Info-ZIP'],
    'zlib': ['ZLIB'],
    'zoom': ['non-free'], # AUR
}

class Package(object):
    def __init__(self, name, licenses):
        self.name = name
        self.licenses = licenses

class UnambiguousDb(object):
    def __init__(self, db):
        self.packages = []

        for pkg in db.search(""):
            if pkg.name in AMBIGUOUS_PACKAGES:
                self.packages.append(Package(pkg.name, AMBIGUOUS_PACKAGES[pkg.name]))
            elif pkg.name.startswith("lib32") and pkg.name[6:] in AMBIGUOUS_PACKAGES:
                self.packages.append(Package(pkg.name, AMBIGUOUS_PACKAGES[pkg.name[6:]]))
            else:
                self.packages.append(Package(pkg.name, pkg.licenses))
